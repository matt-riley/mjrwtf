# Database Configuration (SQLite)
# Path to the SQLite database file.
# Examples:
#   - ./database.db           (local dev)
#   - /app/data/database.db   (Docker with a mounted /app/data volume)
DATABASE_URL=./database.db

# Database operation timeout (default: 5s)
# Applies a bounded deadline to all database operations to prevent hanging
# Format: duration string like "5s", "100ms", "1m30s"
DB_TIMEOUT=5s

# Server Configuration
# Port number for the HTTP server (default: 8080)
SERVER_PORT=8080

# CORS Configuration
# Allowed origins for CORS requests (default: "*" - allows all, not recommended for production)
# For production, specify actual domains: https://example.com,https://app.example.com
ALLOWED_ORIGINS=*

# Authentication
# Preferred: comma-separated list of active tokens (supports rotation).
# If AUTH_TOKENS is set, it takes precedence and AUTH_TOKEN is ignored.
AUTH_TOKENS=

# Legacy single token (used only when AUTH_TOKENS is unset)
AUTH_TOKEN=your-secret-auth-token-here

# Session Configuration
# Enable secure cookies (requires HTTPS)
# Set to true in production with HTTPS, false for local development
SECURE_COOKIES=false

# Rate Limiting
# Requests per minute per IP for public redirect endpoint
REDIRECT_RATE_LIMIT_PER_MINUTE=120
# Requests per minute per IP for authenticated API endpoints
API_RATE_LIMIT_PER_MINUTE=60

# Redirect Analytics (async click recording)
# Worker count for recording click analytics in the background (default: 100)
REDIRECT_CLICK_WORKERS=100
# Queue size for buffered click analytics tasks (default: REDIRECT_CLICK_WORKERS*2)
REDIRECT_CLICK_QUEUE_SIZE=200

# Logging Configuration
# Log level: debug, info, warn, error (default: info)
LOG_LEVEL=info
# Log format: json, pretty (default: json)
# Use "json" for production (Docker-friendly), "pretty" for development
LOG_FORMAT=json

# Panic recovery stack traces (default: true)
# Set to false in production if you want to avoid stack traces in logs/Discord.
LOG_STACK_TRACES=true

# Metrics Configuration
# Require authentication for /metrics endpoint (default: false)
# Set to true in production to protect operational metrics from public access
# When enabled, /metrics requires the same Bearer token as other API endpoints
METRICS_AUTH_ENABLED=false

# Security Headers Configuration
# Enable HTTP Strict Transport Security (HSTS) header (default: false)
# ONLY enable this when the application is behind TLS/HTTPS
# When enabled, browsers will enforce HTTPS for the specified max-age duration
# WARNING: Enabling HSTS without HTTPS will break access to your application
# NOTE: The current implementation uses 'max-age=31536000; includeSubDomains'
#       To enable HSTS preload, modify security_headers.go to add '; preload'
#       after confirming HTTPS works across all subdomains (difficult to undo)
ENABLE_HSTS=false

# Discord Integration (Optional)
# Webhook URL for Discord notifications
DISCORD_WEBHOOK_URL=

# GeoIP Configuration (Optional)
# Enable GeoIP location tracking
GEOIP_ENABLED=false
# Path to GeoIP database file (required if GEOIP_ENABLED=true)
GEOIP_DATABASE=

# Docker Compose (SQLite)
# docker-compose.yml uses a bind-mounted ./data directory for persistence.
# Create it with: mkdir -p data
# Then run migrations on the host with: export DATABASE_URL=./data/database.db && make migrate-up
